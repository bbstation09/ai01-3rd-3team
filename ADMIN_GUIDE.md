# 🎫 관리자 가이드: 로그 분석 및 봇 탐지

> 생성일: 2026-01-23  
> 티켓 예매 시스템 - 행동 데이터 분석 가이드

---

## 1. 관리자가 확인할 수 있는 정보

### 1.1 세션 기본 정보

| 항목 | 설명 | 예시 |
|------|------|------|
| `session_id` | 세션 고유 식별자 | `book_f3i9nplz` |
| `user_ip` | 접속 IP 주소 | `127.0.0.1` |
| `user_email` | 로그인된 사용자 이메일 | `test@example.com` |
| `created_at` | 세션 생성 시각 | `2026-01-23T18:20:36` |
| `stage` | 로그 단계 | `perf`, `que`, `book` |

---

### 1.2 예매 플로우별 수집 데이터

| 단계 | 수집 항목 |
|------|----------|
| 🔒 **보안문자** | 입력값, 성공여부, 시도 횟수, 소요시간(ms), 마우스 궤적 |
| 📍 **구역선택** | 클릭 구역(섹션), 좌표(x,y), 타임스탬프, 마우스 궤적 |
| 🎫 **좌석선택** | 선택 좌석 목록, 클릭 좌표, 호버 좌석/시간, 체류시간 |
| 💳 **할인권종** | 선택 할인유형, 클릭 좌표, 마우스 궤적 |
| 🚚 **배송선택** | 전화번호, 이메일, 배송방법, 클릭 좌표 |
| 💰 **결제수단** | 결제 방법, 클릭 좌표, 마우스 궤적 |

---

### 1.3 행동 분석 데이터

| 데이터 유형 | 형식 | 분석 용도 |
|------------|------|----------|
| **마우스 궤적** | `{x, y, t}` | 움직임 패턴, 곡선 여부 |
| **클릭** | `{x, y, target, timestamp}` | 클릭 위치, 대상, 간격 |
| **호버** | `{target, duration}` | 머문 시간, 탐색 패턴 |

---

## 2. 사람 vs 봇 행동 패턴 비교

### 2.1 마우스 궤적 (Mouse Trajectory)

| 특성 | 👤 사람 | 🤖 봇 |
|------|--------|------|
| **경로 형태** | 곡선, 불규칙적 | 직선, 규칙적 |
| **포인트 수** | 수십~수백 개 | 적음 (0~30개) |
| **속도 변화** | 가속/감속 자연스러움 | 일정하거나 급격한 변화 |
| **미세 떨림** | 있음 (손 움직임) | 없음 (정밀) |

```
사람 궤적 예시:        봇 궤적 예시:
    ~~~,              .-----.
   /    \             |     |
  /      \__,         |     |
 /           \        '-----'
```

---

### 2.2 클릭 패턴 (Click Pattern)

| 특성 | 👤 사람 | 🤖 봇 |
|------|--------|------|
| **클릭 간격** | 불규칙 (0.5~3초) | 일정함 (0.05~1초) |
| **좌표 정확도** | 약간의 오차 | 정확한 픽셀 위치 |
| **더블클릭** | 가끔 실수로 발생 | 의도적/규칙적 |
| **호버 후 클릭** | 자연스러운 탐색 | 즉시 클릭 |

---

### 2.3 체류 시간 (Duration)

| 특성 | 👤 사람 | 🤖 봇 유형별 |
|------|--------|-------------|
| **전체 시간** | 20~120초 | 2~40초 |
| **캡챠 입력** | 3~10초 | 0.1~0.5초 |
| **좌석 선택** | 5~30초 | 1~5초 |

---

### 2.4 호버 행동 (Hover Behavior)

| 특성 | 👤 사람 | 🤖 봇 |
|------|--------|------|
| **호버 횟수** | 많음 (탐색) | 적음 또는 없음 |
| **호버 시간** | 다양함 | 짧거나 고정 |
| **패턴** | 여러 좌석 살펴봄 | 목표 좌석만 |

---

## 3. 봇 유형별 특징

| 봇 유형 | 설명 | 핵심 특징 |
|--------|------|----------|
| **fast_click** | 빠른 클릭 봇 | 클릭 간격 0.05~0.2초, 호버 없음 |
| **linear_move** | 직선 이동 봇 | 마우스가 직선으로만 이동 |
| **repeat_pattern** | 반복 패턴 봇 | 정확히 1초 간격 클릭 |
| **slow_auto** | 느린 자동화 봇 | 사람처럼 보이려 하나 규칙적 |
| **fixed_coord** | 좌표 고정 봇 | 마우스 궤적 없음, 클릭만 |
| **queue_bypass** | 대기열 우회 봇 | 대기열 통과 시간 0.5~2초 |

---

## 4. 봇 탐지 지표 (Bot Score)

| 점수 | 판정 | 시각화 색상 |
|------|------|------------|
| 0~40% | 🟢 정상 | 초록색 |
| 40~70% | 🟡 의심 | 노란색 |
| 70~100% | 🔴 봇 | 빨간색 |

### 주요 탐지 기준
1. ⏱️ 비정상적으로 빠른 완료 시간
2. 📐 직선적인 마우스 이동
3. ⏲️ 일정한 클릭 간격
4. 🖱️ 호버 없이 즉시 클릭
5. 🎯 너무 정확한 좌표

---

## 5. 로그 뷰어 사용법

### 5.1 접속
```
http://localhost:8000/viewer
```

### 5.2 화면 구성
- **왼쪽**: 세션 로그 목록 (정상: 파란 배지, 봇: 빨간 배지)
- **오른쪽**: 상세 정보 (세션 정보, 궤적, 통계, 원본 JSON)

### 5.3 궤적 캔버스
| 표시 | 의미 |
|------|------|
| 🟢 녹색 원 | 시작점 |
| 🟠 주황 원 | 끝점 |
| 🔴 빨간 원 | 클릭 포인트 |
| 🔵 파란 선 | 마우스 이동 궤적 |

### 5.4 hover 정보
포인트에 마우스를 올리면 표시:
- **단계**: 어느 예매 단계인지 (좌석선택, 결제 등)
- **좌표**: (x, y) 픽셀 좌표
- **대상**: 클릭한 요소 (좌석 ID, 버튼 등)

---

## 6. 로그 파일 구조

### 6.1 저장 위치
```
logs/
├── perf_*.json   # 🎭 공연창 로그
├── que_*.json    # ⏳ 대기열 로그
└── book_*.json   # 🎫 예매창 로그 (상세)
```

### 6.2 파일명 규칙
```
{stage}_{session_id}_{날짜}_{시간}_{stage}.json
```

예: `book_f3i9nplz_20260123_182036_book.json`

---

## 7. 분석 체크리스트

### 봇 의심 시 확인사항

- [ ] 마우스 궤적이 직선인가?
- [ ] 클릭 간격이 일정한가?
- [ ] 전체 완료 시간이 비정상적으로 짧은가?
- [ ] 호버 행동이 없거나 극히 적은가?
- [ ] 캡챠 입력 시간이 0.5초 미만인가?
- [ ] 동일 IP에서 반복 세션이 있는가?

---

*이 가이드는 티켓 예매 시스템의 봇/매크로 탐지를 위한 관리자용 문서입니다.*
